<!-- Code Snippet Dialog -->
<dialog
  class="p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 w-[500px]"
  data-app-target="codeDialog"
>
  <div class="p-4 text-zinc-900 dark:text-zinc-100">
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-sm font-semibold">Code Block</h3>
      <button
        type="button"
        data-action="click->app#closeCodeDialog"
        class="p-1 rounded hover:bg-zinc-200 dark:hover:bg-zinc-700 text-zinc-500"
      >
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>

    <!-- Language Input with Autocomplete -->
    <div class="mb-4 relative">
      <label class="block text-xs text-zinc-500 dark:text-zinc-400 mb-1">Language (Tab to autocomplete)</label>
      <input
        type="text"
        data-app-target="codeLanguage"
        data-action="input->app#onCodeLanguageInput keydown->app#onCodeLanguageKeydown"
        class="w-full px-3 py-2 text-sm border border-zinc-300 dark:border-zinc-600 rounded-md bg-white dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono"
        placeholder="javascript, python, ruby..."
        autocomplete="off"
        spellcheck="false"
      >
      <!-- Suggestions dropdown -->
      <div
        class="hidden absolute z-10 w-full mt-1 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-md shadow-lg max-h-48 overflow-y-auto"
        data-app-target="codeSuggestions"
      >
        <!-- Suggestions will be populated by JavaScript -->
      </div>
    </div>

    <!-- Code Content -->
    <div class="mb-4">
      <label class="block text-xs text-zinc-500 dark:text-zinc-400 mb-1">Code (optional) &mdash; Ctrl+Enter to insert</label>
      <textarea
        data-app-target="codeContent"
        data-action="keydown->app#onCodeContentKeydown"
        class="w-full h-48 px-3 py-2 text-sm border border-zinc-300 dark:border-zinc-600 rounded-md bg-white dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono resize-none"
        placeholder="Paste or type your code here..."
        spellcheck="false"
      ></textarea>
    </div>

    <!-- Footer -->
    <div class="flex justify-end gap-2">
      <button
        type="button"
        data-action="click->app#closeCodeDialog"
        class="px-3 py-1.5 text-sm rounded-md hover:bg-zinc-100 dark:hover:bg-zinc-700 text-zinc-700 dark:text-zinc-300"
      >
        Cancel
      </button>
      <button
        type="button"
        data-action="click->app#insertCode"
        class="px-3 py-1.5 text-sm rounded-md bg-blue-500 text-white hover:bg-blue-600"
      >
        Insert Code
      </button>
    </div>
  </div>
</dialog>
