<div class="h-screen w-full flex flex-col bg-[var(--theme-bg-primary)] text-[var(--theme-text-primary)]"
     data-controller="app autosave scroll-sync connection-monitor typewriter"
     data-action="connection-monitor:offline->autosave#onConnectionLost connection-monitor:online->autosave#onConnectionRestored autosave:config-saved->app#onAutosaveConfigSaved autosave:offline-changed->app#onAutosaveOfflineChanged typewriter:toggled->app#onTypewriterToggled typewriter:toggled->scroll-sync#onTypewriterToggled"
     data-app-tree-value="<%= @tree.to_json %>"
     data-app-initial-path-value="<%= @initial_path.to_json %>"
     data-app-initial-note-value="<%= (@initial_note || {}).to_json %>"
     data-app-config-value="<%= (@config || {}).to_json %>">

  <!-- Connection Lost Banner -->
  <%= render "shared/warning_banner",
      target_attr: 'data-connection-monitor-target="banner"',
      message: t('connection.offline_message'),
      icon_animate: "animate-pulse",
      buttons: [
        { label: t('connection.retry'), action: "click->connection-monitor#retry" }
      ] %>

  <!-- Content Loss Warning Banner -->
  <%= render "shared/warning_banner",
      target_attr: 'data-autosave-target="contentLossBanner"',
      message: t('status.content_loss_warning'),
      buttons: [
        { label: t('status.undo'), action: "click->autosave#undoContentLoss" },
        { label: t('status.save_anyway'), action: "click->autosave#saveAnywayAfterWarning" }
      ] %>

  <%= render "notes/header" %>

  <!-- Main Content -->
  <div class="flex-1 flex overflow-hidden">
    <%= render "notes/sidebar" %>
    <%= render "notes/editor_panel" %>
    <%= render "notes/preview_panel" %>
  </div>

  <!-- File Operations (context menu + dialogs) -->
  <%= render "notes/dialogs/file_operations" %>

  <!-- Dialogs -->
  <%= render "notes/dialogs/dialogs" %>
</div>
