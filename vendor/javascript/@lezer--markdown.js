// @lezer/markdown@1.6.3 downloaded from https://ga.jspm.io/npm:@lezer/markdown@1.6.3/dist/index.js

import{NodeProp as e,Tree as t,NodeType as n,Parser as r,NodeSet as s,parseMixed as i}from"@lezer/common";import{Tag as l,styleTags as a,tags as o}from"@lezer/highlight";class CompositeBlock{static create(e,t,n,r,s){let i=r+(r<<8)+e+(t<<4)|0;return new CompositeBlock(e,t,n,i,s,[],[])}constructor(t,n,r,s,i,l,a){this.type=t;this.value=n;this.from=r;this.hash=s;this.end=i;this.children=l;this.positions=a;this.hashProp=[[e.contextHash,s]]}addChild(n,r){n.prop(e.contextHash)!=this.hash&&(n=new t(n.type,n.children,n.positions,n.length,this.hashProp));this.children.push(n);this.positions.push(r)}toTree(e,r=this.end){let s=this.children.length-1;s>=0&&(r=Math.max(r,this.positions[s]+this.children[s].length+this.from));return new t(e.types[this.type],this.children,this.positions,r-this.from).balance({makeTree:(e,r,s)=>new t(n.none,e,r,s,this.hashProp)})}}var h;(function(e){e[e.Document=1]="Document";e[e.CodeBlock=2]="CodeBlock";e[e.FencedCode=3]="FencedCode";e[e.Blockquote=4]="Blockquote";e[e.HorizontalRule=5]="HorizontalRule";e[e.BulletList=6]="BulletList";e[e.OrderedList=7]="OrderedList";e[e.ListItem=8]="ListItem";e[e.ATXHeading1=9]="ATXHeading1";e[e.ATXHeading2=10]="ATXHeading2";e[e.ATXHeading3=11]="ATXHeading3";e[e.ATXHeading4=12]="ATXHeading4";e[e.ATXHeading5=13]="ATXHeading5";e[e.ATXHeading6=14]="ATXHeading6";e[e.SetextHeading1=15]="SetextHeading1";e[e.SetextHeading2=16]="SetextHeading2";e[e.HTMLBlock=17]="HTMLBlock";e[e.LinkReference=18]="LinkReference";e[e.Paragraph=19]="Paragraph";e[e.CommentBlock=20]="CommentBlock";e[e.ProcessingInstructionBlock=21]="ProcessingInstructionBlock";e[e.Escape=22]="Escape";e[e.Entity=23]="Entity";e[e.HardBreak=24]="HardBreak";e[e.Emphasis=25]="Emphasis";e[e.StrongEmphasis=26]="StrongEmphasis";e[e.Link=27]="Link";e[e.Image=28]="Image";e[e.InlineCode=29]="InlineCode";e[e.HTMLTag=30]="HTMLTag";e[e.Comment=31]="Comment";e[e.ProcessingInstruction=32]="ProcessingInstruction";e[e.Autolink=33]="Autolink";e[e.HeaderMark=34]="HeaderMark";e[e.QuoteMark=35]="QuoteMark";e[e.ListMark=36]="ListMark";e[e.LinkMark=37]="LinkMark";e[e.EmphasisMark=38]="EmphasisMark";e[e.CodeMark=39]="CodeMark";e[e.CodeText=40]="CodeText";e[e.CodeInfo=41]="CodeInfo";e[e.LinkTitle=42]="LinkTitle";e[e.LinkLabel=43]="LinkLabel";e[e.URL=44]="URL"})(h||(h={}));class LeafBlock{constructor(e,t){this.start=e;this.content=t;this.marks=[];this.parsers=[]}}class Line{constructor(){this.text="";this.baseIndent=0;this.basePos=0;this.depth=0;this.markers=[];this.pos=0;this.indent=0;this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let e=this.skipSpace(this.basePos);this.indent=this.countIndent(e,this.pos,this.indent);this.pos=e;this.next=e==this.text.length?-1:this.text.charCodeAt(e)}skipSpace(e){return c(this.text,e)}reset(e){this.text=e;this.baseIndent=this.basePos=this.pos=this.indent=0;this.forwardInner();this.depth=1;while(this.markers.length)this.markers.pop()}moveBase(e){this.basePos=e;this.baseIndent=this.countIndent(e,this.pos,this.indent)}moveBaseColumn(e){this.baseIndent=e;this.basePos=this.findColumn(e)}addMarker(e){this.markers.push(e)}countIndent(e,t=0,n=0){for(let r=t;r<e;r++)n+=this.text.charCodeAt(r)==9?4-n%4:1;return n}findColumn(e){let t=0;for(let n=0;t<this.text.length&&n<e;t++)n+=this.text.charCodeAt(t)==9?4-n%4:1;return t}scrub(){if(!this.baseIndent)return this.text;let e="";for(let t=0;t<this.basePos;t++)e+=" ";return e+this.text.slice(this.basePos)}}function f(e,t,n){if(n.pos==n.text.length||e!=t.block&&n.indent>=t.stack[n.depth+1].value+n.baseIndent)return true;if(n.indent>=n.baseIndent+4)return false;let r=(e.type==h.OrderedList?L:b)(n,t,false);return r>0&&(e.type!=h.BulletList||k(n,t,false)<0)&&n.text.charCodeAt(n.pos+r-1)==e.value}const u={[h.Blockquote](e,t,n){if(n.next!=62)return false;n.markers.push(F(h.QuoteMark,t.lineStart+n.pos,t.lineStart+n.pos+1));n.moveBase(n.pos+(d(n.text.charCodeAt(n.pos+1))?2:1));e.end=t.lineStart+n.text.length;return true},[h.ListItem](e,t,n){if(n.indent<n.baseIndent+e.value&&n.next>-1)return false;n.moveBaseColumn(n.baseIndent+e.value);return true},[h.OrderedList]:f,[h.BulletList]:f,[h.Document](){return true}};function d(e){return e==32||e==9||e==10||e==13}function c(e,t=0){while(t<e.length&&d(e.charCodeAt(t)))t++;return t}function p(e,t,n){while(t>n&&d(e.charCodeAt(t-1)))t--;return t}function m(e){if(e.next!=96&&e.next!=126)return-1;let t=e.pos+1;while(t<e.text.length&&e.text.charCodeAt(t)==e.next)t++;if(t<e.pos+3)return-1;if(e.next==96)for(let n=t;n<e.text.length;n++)if(e.text.charCodeAt(n)==96)return-1;return t}function g(e){return e.next!=62?-1:e.text.charCodeAt(e.pos+1)==32?2:1}function k(e,t,n){if(e.next!=42&&e.next!=45&&e.next!=95)return-1;let r=1;for(let t=e.pos+1;t<e.text.length;t++){let n=e.text.charCodeAt(t);if(n==e.next)r++;else if(!d(n))return-1}return n&&e.next==45&&S(e)>-1&&e.depth==t.stack.length&&t.parser.leafBlockParsers.indexOf(P.SetextHeading)>-1||r<3?-1:1}function x(e,t){for(let n=e.stack.length-1;n>=0;n--)if(e.stack[n].type==t)return true;return false}function b(e,t,n){return e.next!=45&&e.next!=43&&e.next!=42||e.pos!=e.text.length-1&&!d(e.text.charCodeAt(e.pos+1))||!(!n||x(t,h.BulletList)||e.skipSpace(e.pos+2)<e.text.length)?-1:1}function L(e,t,n){let r=e.pos,s=e.next;for(;;){if(!(s>=48&&s<=57))break;r++;if(r==e.text.length)return-1;s=e.text.charCodeAt(r)}return r==e.pos||r>e.pos+9||s!=46&&s!=41||r<e.text.length-1&&!d(e.text.charCodeAt(r+1))||n&&!x(t,h.OrderedList)&&(e.skipSpace(r+1)==e.text.length||r>e.pos+1||e.next!=49)?-1:r+1-e.pos}function C(e){if(e.next!=35)return-1;let t=e.pos+1;while(t<e.text.length&&e.text.charCodeAt(t)==35)t++;if(t<e.text.length&&e.text.charCodeAt(t)!=32)return-1;let n=t-e.pos;return n>6?-1:n}function S(e){if(e.next!=45&&e.next!=61||e.indent>=e.baseIndent+4)return-1;let t=e.pos+1;while(t<e.text.length&&e.text.charCodeAt(t)==e.next)t++;let n=t;while(t<e.text.length&&d(e.text.charCodeAt(t)))t++;return t==e.text.length?n:-1}const w=/^[ \t]*$/,y=/-->/,I=/\?>/;const T=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,y],[/^\s*<\?/,I],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,w],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,w]];function A(e,t,n){if(e.next!=60)return-1;let r=e.text.slice(e.pos);for(let e=0,t=T.length-(n?1:0);e<t;e++)if(T[e][0].test(r))return e;return-1}function E(e,t){let n=e.countIndent(t,e.pos,e.indent);let r=e.countIndent(e.skipSpace(t),t,n);return r>=n+5?n+1:r}function B(e,t,n){let r=e.length-1;r>=0&&e[r].to==t&&e[r].type==h.CodeText?e[r].to=n:e.push(F(h.CodeText,t,n))}const M={LinkReference:void 0,IndentedCode(e,t){let n=t.baseIndent+4;if(t.indent<n)return false;let r=t.findColumn(n);let s=e.lineStart+r,i=e.lineStart+t.text.length;let l=[],a=[];B(l,s,i);while(e.nextLine()&&t.depth>=e.stack.length)if(t.pos==t.text.length){B(a,e.lineStart-1,e.lineStart);for(let e of t.markers)a.push(e)}else{if(t.indent<n)break;{if(a.length){for(let e of a)e.type==h.CodeText?B(l,e.from,e.to):l.push(e);a=[]}B(l,e.lineStart-1,e.lineStart);for(let e of t.markers)l.push(e);i=e.lineStart+t.text.length;let n=e.lineStart+t.findColumn(t.baseIndent+4);n<i&&B(l,n,i)}}if(a.length){a=a.filter((e=>e.type!=h.CodeText));a.length&&(t.markers=a.concat(t.markers))}e.addNode(e.buffer.writeElements(l,-s).finish(h.CodeBlock,i-s),s);return true},FencedCode(e,t){let n=m(t);if(n<0)return false;let r=e.lineStart+t.pos,s=t.next,i=n-t.pos;let l=t.skipSpace(n),a=p(t.text,t.text.length,l);let o=[F(h.CodeMark,r,r+i)];l<a&&o.push(F(h.CodeInfo,e.lineStart+l,e.lineStart+a));for(let n=true,r=true,l=false;e.nextLine()&&t.depth>=e.stack.length;n=false){let a=t.pos;if(t.indent-t.baseIndent<4)while(a<t.text.length&&t.text.charCodeAt(a)==s)a++;if(a-t.pos>=i&&t.skipSpace(a)==t.text.length){for(let e of t.markers)o.push(e);r&&l&&B(o,e.lineStart-1,e.lineStart);o.push(F(h.CodeMark,e.lineStart+t.pos,e.lineStart+a));e.nextLine();break}{l=true;if(!n){B(o,e.lineStart-1,e.lineStart);r=false}for(let e of t.markers)o.push(e);let s=e.lineStart+t.basePos,i=e.lineStart+t.text.length;if(s<i){B(o,s,i);r=false}}}e.addNode(e.buffer.writeElements(o,-r).finish(h.FencedCode,e.prevLineEnd()-r),r);return true},Blockquote(e,t){let n=g(t);if(n<0)return false;e.startContext(h.Blockquote,t.pos);e.addNode(h.QuoteMark,e.lineStart+t.pos,e.lineStart+t.pos+1);t.moveBase(t.pos+n);return null},HorizontalRule(e,t){if(k(t,e,false)<0)return false;let n=e.lineStart+t.pos;e.nextLine();e.addNode(h.HorizontalRule,n);return true},BulletList(e,t){let n=b(t,e,false);if(n<0)return false;e.block.type!=h.BulletList&&e.startContext(h.BulletList,t.basePos,t.next);let r=E(t,t.pos+1);e.startContext(h.ListItem,t.basePos,r-t.baseIndent);e.addNode(h.ListMark,e.lineStart+t.pos,e.lineStart+t.pos+n);t.moveBaseColumn(r);return null},OrderedList(e,t){let n=L(t,e,false);if(n<0)return false;e.block.type!=h.OrderedList&&e.startContext(h.OrderedList,t.basePos,t.text.charCodeAt(t.pos+n-1));let r=E(t,t.pos+n);e.startContext(h.ListItem,t.basePos,r-t.baseIndent);e.addNode(h.ListMark,e.lineStart+t.pos,e.lineStart+t.pos+n);t.moveBaseColumn(r);return null},ATXHeading(e,t){let n=C(t);if(n<0)return false;let r=t.pos,s=e.lineStart+r;let i=p(t.text,t.text.length,r),l=i;while(l>r&&t.text.charCodeAt(l-1)==t.next)l--;l!=i&&l!=r&&d(t.text.charCodeAt(l-1))||(l=t.text.length);let a=e.buffer.write(h.HeaderMark,0,n).writeElements(e.parser.parseInline(t.text.slice(r+n+1,l),s+n+1),-s);l<t.text.length&&a.write(h.HeaderMark,l-r,i-r);let o=a.finish(h.ATXHeading1-1+n,t.text.length-r);e.nextLine();e.addNode(o,s);return true},HTMLBlock(e,t){let n=A(t,e,false);if(n<0)return false;let r=e.lineStart+t.pos,s=T[n][1];let i=[],l=s!=w;while(!s.test(t.text)&&e.nextLine()){if(t.depth<e.stack.length){l=false;break}for(let e of t.markers)i.push(e)}l&&e.nextLine();let a=s==y?h.CommentBlock:s==I?h.ProcessingInstructionBlock:h.HTMLBlock;let o=e.prevLineEnd();e.addNode(e.buffer.writeElements(i,-r).finish(a,o-r),r);return true},SetextHeading:void 0};class LinkReferenceParser{constructor(e){this.stage=0;this.elts=[];this.pos=0;this.start=e.start;this.advance(e.content)}nextLine(e,t,n){if(this.stage==-1)return false;let r=n.content+"\n"+t.scrub();let s=this.advance(r);return s>-1&&s<r.length&&this.complete(e,n,s)}finish(e,t){return(this.stage==2||this.stage==3)&&c(t.content,this.pos)==t.content.length&&this.complete(e,t,t.content.length)}complete(e,t,n){e.addLeafElement(t,F(h.LinkReference,this.start,this.start+n,this.elts));return true}nextStage(e){if(e){this.pos=e.to-this.start;this.elts.push(e);this.stage++;return true}e===false&&(this.stage=-1);return false}advance(e){for(;;){if(this.stage==-1)return-1;if(this.stage==0){if(!this.nextStage(W(e,this.pos,this.start,true)))return-1;if(e.charCodeAt(this.pos)!=58)return this.stage=-1;this.elts.push(F(h.LinkMark,this.pos+this.start,this.pos+this.start+1));this.pos++}else{if(this.stage!=1){if(this.stage==2){let t=c(e,this.pos),n=0;if(t>this.pos){let r=K(e,t,this.start);if(r){let t=H(e,r.to-this.start);if(t>0){this.nextStage(r);n=t}}}n||(n=H(e,this.pos));return n>0&&n<e.length?n:-1}return H(e,this.pos)}if(!this.nextStage(J(e,c(e,this.pos),this.start)))return-1}}}}function H(e,t){for(;t<e.length;t++){let n=e.charCodeAt(t);if(n==10)break;if(!d(n))return-1}return t}class SetextHeadingParser{nextLine(e,t,n){let r=t.depth<e.stack.length?-1:S(t);let s=t.next;if(r<0)return false;let i=F(h.HeaderMark,e.lineStart+t.pos,e.lineStart+r);e.nextLine();e.addLeafElement(n,F(s==61?h.SetextHeading1:h.SetextHeading2,n.start,e.prevLineEnd(),[...e.parser.parseInline(n.content,n.start),i]));return true}finish(){return false}}const P={LinkReference(e,t){return t.content.charCodeAt(0)==91?new LinkReferenceParser(t):null},SetextHeading(){return new SetextHeadingParser}};const v=[(e,t)=>C(t)>=0,(e,t)=>m(t)>=0,(e,t)=>g(t)>=0,(e,t)=>b(t,e,true)>=0,(e,t)=>L(t,e,true)>=0,(e,t)=>k(t,e,true)>=0,(e,t)=>A(t,e,true)>=0];const N={text:"",end:0};class BlockContext{constructor(e,t,n,r){this.parser=e;this.input=t;this.ranges=r;this.line=new Line;this.atEnd=false;this.reusePlaceholders=new Map;this.stoppedAt=null;this.rangeI=0;this.to=r[r.length-1].to;this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=r[0].from;this.block=CompositeBlock.create(h.Document,0,this.lineStart,0,0);this.stack=[this.block];this.fragments=n.length?new FragmentCursor(n,t):null;this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(this.stoppedAt!=null&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:e}=this;for(;;){for(let t=0;;){let n=e.depth<this.stack.length?this.stack[this.stack.length-1]:null;while(t<e.markers.length&&(!n||e.markers[t].from<n.end)){let n=e.markers[t++];this.addNode(n.type,n.from,n.to)}if(!n)break;this.finishContext()}if(e.pos<e.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(e.basePos))return null;e:for(;;){for(let t of this.parser.blockParsers)if(t){let n=t(this,e);if(n!=false){if(n==true)return null;e.forward();continue e}}break}let t=new LeafBlock(this.lineStart+e.pos,e.text.slice(e.pos));for(let e of this.parser.leafBlockParsers)if(e){let n=e(this,t);n&&t.parsers.push(n)}e:while(this.nextLine()){if(e.pos==e.text.length)break;if(e.indent<e.baseIndent+4)for(let n of this.parser.endLeafBlock)if(n(this,e,t))break e;for(let n of t.parsers)if(n.nextLine(this,e,t))return null;t.content+="\n"+e.scrub();for(let n of e.markers)t.marks.push(n)}this.finishLeaf(t);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}reuseFragment(e){if(!this.fragments.moveTo(this.absoluteLineStart+e,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return false;let t=this.fragments.takeNodes(this);if(!t)return false;this.absoluteLineStart+=t;this.lineStart=te(this.absoluteLineStart,this.ranges);this.moveRangeI();if(this.absoluteLineStart<this.to){this.lineStart++;this.absoluteLineStart++;this.readLine()}else{this.atEnd=true;this.readLine()}return true}get depth(){return this.stack.length}parentType(e=this.depth-1){return this.parser.nodeSet.types[this.stack[e].type]}nextLine(){this.lineStart+=this.line.text.length;if(this.absoluteLineEnd>=this.to){this.absoluteLineStart=this.absoluteLineEnd;this.atEnd=true;this.readLine();return false}this.lineStart++;this.absoluteLineStart=this.absoluteLineEnd+1;this.moveRangeI();this.readLine();return true}peekLine(){return this.scanLine(this.absoluteLineEnd+1).text}moveRangeI(){while(this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to){this.rangeI++;this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}}scanLine(e){let t=N;t.end=e;if(e>=this.to)t.text="";else{t.text=this.lineChunkAt(e);t.end+=t.text.length;if(this.ranges.length>1){let e=this.absoluteLineStart,n=this.rangeI;while(this.ranges[n].to<t.end){n++;let r=this.ranges[n].from;let s=this.lineChunkAt(r);t.end=r+s.length;t.text=t.text.slice(0,this.ranges[n-1].to-e)+s;e=t.end-t.text.length}}}return t}readLine(){let{line:e}=this,{text:t,end:n}=this.scanLine(this.absoluteLineStart);this.absoluteLineEnd=n;e.reset(t);for(;e.depth<this.stack.length;e.depth++){let t=this.stack[e.depth],n=this.parser.skipContextMarkup[t.type];if(!n)throw new Error("Unhandled block context "+h[t.type]);let r=this.line.markers.length;if(!n(t,this,e)){this.line.markers.length>r&&(t.end=this.line.markers[this.line.markers.length-1].to);e.forward();break}e.forward()}}lineChunkAt(e){let t,n=this.input.chunk(e);if(this.input.lineChunks)t=n=="\n"?"":n;else{let e=n.indexOf("\n");t=e<0?n:n.slice(0,e)}return e+t.length>this.to?t.slice(0,this.to-e):t}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(e,t,n=0){this.block=CompositeBlock.create(e,n,this.lineStart+t,this.block.hash,this.lineStart+this.line.text.length);this.stack.push(this.block)}startComposite(e,t,n=0){this.startContext(this.parser.getNodeType(e),t,n)}addNode(e,n,r){typeof e=="number"&&(e=new t(this.parser.nodeSet.types[e],$,$,(r!==null&&r!==void 0?r:this.prevLineEnd())-n));this.block.addChild(e,n-this.block.from)}addElement(e){this.block.addChild(e.toTree(this.parser.nodeSet),e.from-this.block.from)}addLeafElement(e,t){this.addNode(this.buffer.writeElements(Y(t.children,e.marks),-t.from).finish(t.type,t.to-t.from),t.from)}finishContext(){let e=this.stack.pop();let t=this.stack[this.stack.length-1];t.addChild(e.toTree(this.parser.nodeSet),e.from-t.from);this.block=t}finish(){while(this.stack.length>1)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(e){return this.ranges.length>1?O(this.ranges,0,e.topNode,this.ranges[0].from,this.reusePlaceholders):e}finishLeaf(e){for(let t of e.parsers)if(t.finish(this,e))return;let t=Y(this.parser.parseInline(e.content,e.start),e.marks);this.addNode(this.buffer.writeElements(t,-e.start).finish(h.Paragraph,e.content.length),e.start)}elt(e,t,n,r){return typeof e=="string"?F(this.parser.getNodeType(e),t,n,r):new TreeElement(e,t)}get buffer(){return new Buffer(this.parser.nodeSet)}}function O(e,n,r,s,i){let l=e[n].to;let a=[],o=[],h=r.from+s;function f(t,r){while(r?t>=l:t>l){let r=e[n+1].from-l;s+=r;t+=r;n++;l=e[n].to}}for(let t=r.firstChild;t;t=t.nextSibling){f(t.from+s,true);let r,u=t.from+s,d=i.get(t.tree);if(d)r=d;else if(t.to+s>l){r=O(e,n,t,s,i);f(t.to+s,false)}else r=t.toTree();a.push(r);o.push(u-h)}f(r.to+s,false);return new t(r.type,a,o,r.to+s-h,r.tree?r.tree.propValues:void 0)}class MarkdownParser extends r{constructor(e,t,n,r,s,i,l,a,o){super();this.nodeSet=e;this.blockParsers=t;this.leafBlockParsers=n;this.blockNames=r;this.endLeafBlock=s;this.skipContextMarkup=i;this.inlineParsers=l;this.inlineNames=a;this.wrappers=o;this.nodeTypes=Object.create(null);for(let t of e.types)this.nodeTypes[t.name]=t.id}createParse(e,t,n){let r=new BlockContext(this,e,t,n);for(let s of this.wrappers)r=s(r,e,t,n);return r}configure(t){let r=R(t);if(!r)return this;let{nodeSet:i,skipContextMarkup:o}=this;let f=this.blockParsers.slice(),u=this.leafBlockParsers.slice(),d=this.blockNames.slice(),c=this.inlineParsers.slice(),p=this.inlineNames.slice(),m=this.endLeafBlock.slice(),g=this.wrappers;if(D(r.defineNodes)){o=Object.assign({},o);let t,f=i.types.slice();for(let s of r.defineNodes){let{name:r,block:i,composite:a,style:u}=typeof s=="string"?{name:s}:s;if(f.some((e=>e.name==r)))continue;a&&(o[f.length]=(e,t,n)=>a(t,n,e.value));let d=f.length;let c=a?["Block","BlockContext"]:i?d>=h.ATXHeading1&&d<=h.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;f.push(n.define({id:d,name:r,props:c&&[[e.group,c]]}));if(u){t||(t={});Array.isArray(u)||u instanceof l?t[r]=u:Object.assign(t,u)}}i=new s(f);t&&(i=i.extend(a(t)))}D(r.props)&&(i=i.extend(...r.props));if(D(r.remove))for(let e of r.remove){let t=this.blockNames.indexOf(e),n=this.inlineNames.indexOf(e);t>-1&&(f[t]=u[t]=void 0);n>-1&&(c[n]=void 0)}if(D(r.parseBlock))for(let e of r.parseBlock){let t=d.indexOf(e.name);if(t>-1){f[t]=e.parse;u[t]=e.leaf}else{let t=e.before?z(d,e.before):e.after?z(d,e.after)+1:d.length-1;f.splice(t,0,e.parse);u.splice(t,0,e.leaf);d.splice(t,0,e.name)}e.endLeaf&&m.push(e.endLeaf)}if(D(r.parseInline))for(let e of r.parseInline){let t=p.indexOf(e.name);if(t>-1)c[t]=e.parse;else{let t=e.before?z(p,e.before):e.after?z(p,e.after)+1:p.length-1;c.splice(t,0,e.parse);p.splice(t,0,e.name)}}r.wrap&&(g=g.concat(r.wrap));return new MarkdownParser(i,f,u,d,m,o,c,p,g)}getNodeType(e){let t=this.nodeTypes[e];if(t==null)throw new RangeError(`Unknown node type '${e}'`);return t}parseInline(e,t){let n=new InlineContext(this,e,t);e:for(let e=t;e<n.end;){let t=n.char(e);for(let r of this.inlineParsers)if(r){let s=r(n,t,e);if(s>=0){e=s;continue e}}e++}return n.resolveMarkers(0)}}function D(e){return e!=null&&e.length>0}function R(e){if(!Array.isArray(e))return e;if(e.length==0)return null;let t=R(e[0]);if(e.length==1)return t;let n=R(e.slice(1));if(!n||!t)return t||n;let r=(e,t)=>(e||$).concat(t||$);let s=t.wrap,i=n.wrap;return{props:r(t.props,n.props),defineNodes:r(t.defineNodes,n.defineNodes),parseBlock:r(t.parseBlock,n.parseBlock),parseInline:r(t.parseInline,n.parseInline),remove:r(t.remove,n.remove),wrap:s?i?(e,t,n,r)=>s(i(e,t,n,r),t,n,r):s:i}}function z(e,t){let n=e.indexOf(t);if(n<0)throw new RangeError(`Position specified relative to unknown parser ${t}`);return n}let X=[n.none];for(let t,r=1;t=h[r];r++)X[r]=n.define({id:r,name:t,props:r>=h.Escape?[]:[[e.group,r in u?["Block","BlockContext"]:["Block","LeafBlock"]]],top:t=="Document"});const $=[];class Buffer{constructor(e){this.nodeSet=e;this.content=[];this.nodes=[]}write(e,t,n,r=0){this.content.push(e,t,n,4+r*4);return this}writeElements(e,t=0){for(let n of e)n.writeTo(this,t);return this}finish(e,n){return t.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:e,length:n})}}class Element{constructor(e,t,n,r=$){this.type=e;this.from=t;this.to=n;this.children=r}writeTo(e,t){let n=e.content.length;e.writeElements(this.children,t);e.content.push(this.type,this.from+t,this.to+t,e.content.length+4-n)}toTree(e){return new Buffer(e).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}}class TreeElement{constructor(e,t){this.tree=e;this.from=t}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return $}writeTo(e,t){e.nodes.push(this.tree);e.content.push(e.nodes.length-1,this.from+t,this.to+t,-1)}toTree(){return this.tree}}function F(e,t,n,r){return new Element(e,t,n,r)}const j={resolve:"Emphasis",mark:"EmphasisMark"};const q={resolve:"Emphasis",mark:"EmphasisMark"};const U={},_={};class InlineDelimiter{constructor(e,t,n,r){this.type=e;this.from=t;this.to=n;this.side=r}}const Z="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";let Q=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{Q=new RegExp("[\\p{S}|\\p{P}]","u")}catch(e){}const G={Escape(e,t,n){if(t!=92||n==e.end-1)return-1;let r=e.char(n+1);for(let t=0;t<Z.length;t++)if(Z.charCodeAt(t)==r)return e.append(F(h.Escape,n,n+2));return-1},Entity(e,t,n){if(t!=38)return-1;let r=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(e.slice(n+1,n+31));return r?e.append(F(h.Entity,n,n+1+r[0].length)):-1},InlineCode(e,t,n){if(t!=96||n&&e.char(n-1)==96)return-1;let r=n+1;while(r<e.end&&e.char(r)==96)r++;let s=r-n,i=0;for(;r<e.end;r++)if(e.char(r)==96){i++;if(i==s&&e.char(r+1)!=96)return e.append(F(h.InlineCode,n,r+1,[F(h.CodeMark,n,n+s),F(h.CodeMark,r+1-s,r+1)]))}else i=0;return-1},HTMLTag(e,t,n){if(t!=60||n==e.end-1)return-1;let r=e.slice(n+1,e.end);let s=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(r);if(s)return e.append(F(h.Autolink,n,n+1+s[0].length,[F(h.LinkMark,n,n+1),F(h.URL,n+1,n+s[0].length),F(h.LinkMark,n+s[0].length,n+1+s[0].length)]));let i=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(r);if(i)return e.append(F(h.Comment,n,n+1+i[0].length));let l=/^\?[^]*?\?>/.exec(r);if(l)return e.append(F(h.ProcessingInstruction,n,n+1+l[0].length));let a=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(r);return a?e.append(F(h.HTMLTag,n,n+1+a[0].length)):-1},Emphasis(e,t,n){if(t!=95&&t!=42)return-1;let r=n+1;while(e.char(r)==t)r++;let s=e.slice(n-1,n),i=e.slice(r,r+1);let l=Q.test(s),a=Q.test(i);let o=/\s|^$/.test(s),h=/\s|^$/.test(i);let f=!h&&(!a||o||l);let u=!o&&(!l||h||a);let d=f&&(t==42||!u||l);let c=u&&(t==42||!f||a);return e.append(new InlineDelimiter(t==95?j:q,n,r,(d?1:0)|(c?2:0)))},HardBreak(e,t,n){if(t==92&&e.char(n+1)==10)return e.append(F(h.HardBreak,n,n+2));if(t==32){let t=n+1;while(e.char(t)==32)t++;if(e.char(t)==10&&t>=n+2)return e.append(F(h.HardBreak,n,t+1))}return-1},Link(e,t,n){return t==91?e.append(new InlineDelimiter(U,n,n+1,1)):-1},Image(e,t,n){return t==33&&e.char(n+1)==91?e.append(new InlineDelimiter(_,n,n+2,1)):-1},LinkEnd(e,t,n){if(t!=93)return-1;for(let t=e.parts.length-1;t>=0;t--){let r=e.parts[t];if(r instanceof InlineDelimiter&&(r.type==U||r.type==_)){if(!r.side||e.skipSpace(r.to)==n&&!/[(\[]/.test(e.slice(n+1,n+2))){e.parts[t]=null;return-1}let s=e.takeContent(t);let i=e.parts[t]=V(e,s,r.type==U?h.Link:h.Image,r.from,n+1);if(r.type==U)for(let n=0;n<t;n++){let t=e.parts[n];t instanceof InlineDelimiter&&t.type==U&&(t.side=0)}return i.to}}return-1}};function V(e,t,n,r,s){let{text:i}=e,l=e.char(s),a=s;t.unshift(F(h.LinkMark,r,r+(n==h.Image?2:1)));t.push(F(h.LinkMark,s-1,s));if(l==40){let n=e.skipSpace(s+1);let r,l=J(i,n-e.offset,e.offset);if(l){n=e.skipSpace(l.to);if(n!=l.to){r=K(i,n-e.offset,e.offset);r&&(n=e.skipSpace(r.to))}}if(e.char(n)==41){t.push(F(h.LinkMark,s,s+1));a=n+1;l&&t.push(l);r&&t.push(r);t.push(F(h.LinkMark,n,a))}}else if(l==91){let n=W(i,s-e.offset,e.offset,false);if(n){t.push(n);a=n.to}}return F(n,r,a,t)}function J(e,t,n){let r=e.charCodeAt(t);if(r==60){for(let r=t+1;r<e.length;r++){let s=e.charCodeAt(r);if(s==62)return F(h.URL,t+n,r+1+n);if(s==60||s==10)return false}return null}{let r=0,s=t;for(let t=false;s<e.length;s++){let n=e.charCodeAt(s);if(d(n))break;if(t)t=false;else if(n==40)r++;else if(n==41){if(!r)break;r--}else n==92&&(t=true)}return s>t?F(h.URL,t+n,s+n):s==e.length&&null}}function K(e,t,n){let r=e.charCodeAt(t);if(r!=39&&r!=34&&r!=40)return false;let s=r==40?41:r;for(let r=t+1,i=false;r<e.length;r++){let l=e.charCodeAt(r);if(i)i=false;else{if(l==s)return F(h.LinkTitle,t+n,r+1+n);l==92&&(i=true)}}return null}function W(e,t,n,r){for(let s=false,i=t+1,l=Math.min(e.length,i+999);i<l;i++){let l=e.charCodeAt(i);if(s)s=false;else{if(l==93)return!r&&F(h.LinkLabel,t+n,i+1+n);r&&!d(l)&&(r=false);if(l==91)return false;l==92&&(s=true)}}return null}class InlineContext{constructor(e,t,n){this.parser=e;this.text=t;this.offset=n;this.parts=[]}char(e){return e>=this.end?-1:this.text.charCodeAt(e-this.offset)}get end(){return this.offset+this.text.length}slice(e,t){return this.text.slice(e-this.offset,t-this.offset)}append(e){this.parts.push(e);return e.to}addDelimiter(e,t,n,r,s){return this.append(new InlineDelimiter(e,t,n,(r?1:0)|(s?2:0)))}get hasOpenLink(){for(let e=this.parts.length-1;e>=0;e--){let t=this.parts[e];if(t instanceof InlineDelimiter&&(t.type==U||t.type==_))return true}return false}addElement(e){return this.append(e)}resolveMarkers(e){for(let t=e;t<this.parts.length;t++){let n=this.parts[t];if(!(n instanceof InlineDelimiter&&n.type.resolve&&n.side&2))continue;let r=n.type==j||n.type==q;let s=n.to-n.from;let i,l=t-1;for(;l>=e;l--){let e=this.parts[l];if(e instanceof InlineDelimiter&&e.side&1&&e.type==n.type&&!(r&&(n.side&1||e.side&2)&&(e.to-e.from+s)%3==0&&((e.to-e.from)%3||s%3))){i=e;break}}if(!i)continue;let a=n.type.resolve,o=[];let h=i.from,f=n.to;if(r){let e=Math.min(2,i.to-i.from,s);h=i.to-e;f=n.from+e;a=e==1?"Emphasis":"StrongEmphasis"}i.type.mark&&o.push(this.elt(i.type.mark,h,i.to));for(let e=l+1;e<t;e++){this.parts[e]instanceof Element&&o.push(this.parts[e]);this.parts[e]=null}n.type.mark&&o.push(this.elt(n.type.mark,n.from,f));let u=this.elt(a,h,f,o);this.parts[l]=r&&i.from!=h?new InlineDelimiter(i.type,i.from,h,i.side):null;let d=this.parts[t]=r&&n.to!=f?new InlineDelimiter(n.type,f,n.to,n.side):null;d?this.parts.splice(t,0,u):this.parts[t]=u}let t=[];for(let n=e;n<this.parts.length;n++){let e=this.parts[n];e instanceof Element&&t.push(e)}return t}findOpeningDelimiter(e){for(let t=this.parts.length-1;t>=0;t--){let n=this.parts[t];if(n instanceof InlineDelimiter&&n.type==e&&n.side&1)return t}return null}takeContent(e){let t=this.resolveMarkers(e);this.parts.length=e;return t}getDelimiterAt(e){let t=this.parts[e];return t instanceof InlineDelimiter?t:null}skipSpace(e){return c(this.text,e-this.offset)+this.offset}elt(e,t,n,r){return typeof e=="string"?F(this.parser.getNodeType(e),t,n,r):new TreeElement(e,t)}}InlineContext.linkStart=U;InlineContext.imageStart=_;function Y(e,t){if(!t.length)return e;if(!e.length)return t;let n=e.slice(),r=0;for(let e of t){while(r<n.length&&n[r].to<e.to)r++;if(r<n.length&&n[r].from<e.from){let t=n[r];t instanceof Element&&(n[r]=new Element(t.type,t.from,t.to,Y(t.children,[e])))}else n.splice(r++,0,e)}return n}const ee=[h.CodeBlock,h.ListItem,h.OrderedList,h.BulletList];class FragmentCursor{constructor(e,t){this.fragments=e;this.input=t;this.i=0;this.fragment=null;this.fragmentEnd=-1;this.cursor=null;e.length&&(this.fragment=e[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null;this.cursor=null;this.fragmentEnd=-1}moveTo(e,t){while(this.fragment&&this.fragment.to<=e)this.nextFragment();if(!this.fragment||this.fragment.from>(e?e-1:0))return false;if(this.fragmentEnd<0){let e=this.fragment.to;while(e>0&&this.input.read(e-1,e)!="\n")e--;this.fragmentEnd=e?e-1:0}let n=this.cursor;if(!n){n=this.cursor=this.fragment.tree.cursor();n.firstChild()}let r=e+this.fragment.offset;while(n.to<=r)if(!n.parent())return false;for(;;){if(n.from>=r)return this.fragment.from<=t;if(!n.childAfter(r))return false}}matches(t){let n=this.cursor.tree;return n&&n.prop(e.contextHash)==t}takeNodes(e){let n=this.cursor,r=this.fragment.offset,s=this.fragmentEnd-(this.fragment.openEnd?1:0);let i=e.absoluteLineStart,l=i,a=e.block.children.length;let o=l,f=a;for(;;){if(n.to-r>s){if(n.type.isAnonymous&&n.firstChild())continue;break}let i=te(n.from-r,e.ranges);if(n.to-r<=e.ranges[e.rangeI].to)e.addNode(n.tree,i);else{let r=new t(e.parser.nodeSet.types[h.Paragraph],[],[],0,e.block.hashProp);e.reusePlaceholders.set(r,n.tree);e.addNode(r,i)}if(n.type.is("Block")){if(ee.indexOf(n.type.id)<0){l=n.to-r;a=e.block.children.length}else{l=o;a=f}o=n.to-r;f=e.block.children.length}if(!n.nextSibling())break}while(e.block.children.length>a){e.block.children.pop();e.block.positions.pop()}return l-i}}function te(e,t){let n=e;for(let r=1;r<t.length;r++){let s=t[r-1].to,i=t[r].from;s<e&&(n-=i-s)}return n}const ne=a({"Blockquote/...":o.quote,HorizontalRule:o.contentSeparator,"ATXHeading1/... SetextHeading1/...":o.heading1,"ATXHeading2/... SetextHeading2/...":o.heading2,"ATXHeading3/...":o.heading3,"ATXHeading4/...":o.heading4,"ATXHeading5/...":o.heading5,"ATXHeading6/...":o.heading6,"Comment CommentBlock":o.comment,Escape:o.escape,Entity:o.character,"Emphasis/...":o.emphasis,"StrongEmphasis/...":o.strong,"Link/... Image/...":o.link,"OrderedList/... BulletList/...":o.list,"BlockQuote/...":o.quote,"InlineCode CodeText":o.monospace,"URL Autolink":o.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":o.processingInstruction,"CodeInfo LinkLabel":o.labelName,LinkTitle:o.string,Paragraph:o.content});const re=new MarkdownParser(new s(X).extend(ne),Object.keys(M).map((e=>M[e])),Object.keys(M).map((e=>P[e])),Object.keys(M),v,u,Object.keys(G).map((e=>G[e])),Object.keys(G),[]);function se(e,t,n){let r=[];for(let s=e.firstChild,i=t;;s=s.nextSibling){let e=s?s.from:n;e>i&&r.push({from:i,to:e});if(!s)break;i=s.to}return r}function ie(e){let{codeParser:t,htmlParser:n}=e;let r=i(((e,r)=>{let s=e.type.id;if(!t||s!=h.CodeBlock&&s!=h.FencedCode){if(n&&(s==h.HTMLBlock||s==h.HTMLTag||s==h.CommentBlock))return{parser:n,overlay:se(e.node,e.from,e.to)}}else{let n="";if(s==h.FencedCode){let t=e.node.getChild(h.CodeInfo);t&&(n=r.read(t.from,t.to))}let i=t(n);if(i)return{parser:i,overlay:e=>e.type.id==h.CodeText,bracketed:s==h.FencedCode}}return null}));return{wrap:r}}const le={resolve:"Strikethrough",mark:"StrikethroughMark"};const ae={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":o.strikethrough}},{name:"StrikethroughMark",style:o.processingInstruction}],parseInline:[{name:"Strikethrough",parse(e,t,n){if(t!=126||e.char(n+1)!=126||e.char(n+2)==126)return-1;let r=e.slice(n-1,n),s=e.slice(n+2,n+3);let i=/\s|^$/.test(r),l=/\s|^$/.test(s);let a=Q.test(r),o=Q.test(s);return e.addDelimiter(le,n,n+2,!l&&(!o||i||a),!i&&(!a||l||o))},after:"Emphasis"}]};function oe(e,t,n=0,r,s=0){let i=0,l=true,a=-1,o=-1,h=false;let f=()=>{r.push(e.elt("TableCell",s+a,s+o,e.parser.parseInline(t.slice(a,o),s+a)))};for(let u=n;u<t.length;u++){let n=t.charCodeAt(u);if(n!=124||h){if(h||n!=32&&n!=9){a<0&&(a=u);o=u+1}}else{(!l||a>-1)&&i++;l=false;if(r){a>-1&&f();r.push(e.elt("TableDelimiter",u+s,u+s+1))}a=o=-1}h=!h&&n==92}if(a>-1){i++;r&&f()}return i}function he(e,t){for(let n=t;n<e.length;n++){let t=e.charCodeAt(n);if(t==124)return true;t==92&&n++}return false}const fe=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;class TableParser{constructor(){this.rows=null}nextLine(e,t,n){if(this.rows==null){this.rows=false;let r;if((t.next==45||t.next==58||t.next==124)&&fe.test(r=t.text.slice(t.pos))){let s=[],i=oe(e,n.content,0,s,n.start);i==oe(e,r,t.pos)&&(this.rows=[e.elt("TableHeader",n.start,n.start+n.content.length,s),e.elt("TableDelimiter",e.lineStart+t.pos,e.lineStart+t.text.length)])}}else if(this.rows){let n=[];oe(e,t.text,t.pos,n,e.lineStart);this.rows.push(e.elt("TableRow",e.lineStart+t.pos,e.lineStart+t.text.length,n))}return false}finish(e,t){if(!this.rows)return false;e.addLeafElement(t,e.elt("Table",t.start,t.start+t.content.length,this.rows));return true}}const ue={defineNodes:[{name:"Table",block:true},{name:"TableHeader",style:{"TableHeader/...":o.heading}},"TableRow",{name:"TableCell",style:o.content},{name:"TableDelimiter",style:o.processingInstruction}],parseBlock:[{name:"Table",leaf(e,t){return he(t.content,0)?new TableParser:null},endLeaf(e,t,n){if(n.parsers.some((e=>e instanceof TableParser))||!he(t.text,t.basePos))return false;let r=e.peekLine();return fe.test(r)&&oe(e,t.text,t.basePos)==oe(e,r,t.basePos)},before:"SetextHeading"}]};class TaskParser{nextLine(){return false}finish(e,t){e.addLeafElement(t,e.elt("Task",t.start,t.start+t.content.length,[e.elt("TaskMarker",t.start,t.start+3),...e.parser.parseInline(t.content.slice(3),t.start+3)]));return true}}const de={defineNodes:[{name:"Task",block:true,style:o.list},{name:"TaskMarker",style:o.atom}],parseBlock:[{name:"TaskList",leaf(e,t){return/^\[[ xX]\][ \t]/.test(t.content)&&e.parentType().name=="ListItem"?new TaskParser:null},after:"SetextHeading"}]};const ce=/(www\.)|(https?:\/\/)|([\w.+-]{1,100}@)|(mailto:|xmpp:)/gy;const pe=/[\w-]+(\.[\w-]+)+(\/[^\s<]*)?/gy;const me=/[\w-]+\.[\w-]+($|\/)/;const ge=/[\w.+-]+@[\w-]+(\.[\w.-]+)+/gy;const ke=/\/[a-zA-Z\d@.]+/gy;function xe(e,t,n,r){let s=0;for(let i=t;i<n;i++)e[i]==r&&s++;return s}function be(e,t){pe.lastIndex=t;let n=pe.exec(e);if(!n||me.exec(n[0])[0].indexOf("_")>-1)return-1;let r=t+n[0].length;for(;;){let n,s=e[r-1];if(/[?!.,:*_~]/.test(s)||s==")"&&xe(e,t,r,")")>xe(e,t,r,"("))r--;else{if(s!=";"||!(n=/&(?:#\d+|#x[a-f\d]+|\w+);$/.exec(e.slice(t,r))))break;r=t+n.index}}return r}function Le(e,t){ge.lastIndex=t;let n=ge.exec(e);if(!n)return-1;let r=n[0][n[0].length-1];return r=="_"||r=="-"?-1:t+n[0].length-(r=="."?1:0)}const Ce={parseInline:[{name:"Autolink",parse(e,t,n){let r=n-e.offset;if(r&&/\w/.test(e.text[r-1]))return-1;ce.lastIndex=r;let s=ce.exec(e.text),i=-1;if(!s)return-1;if(s[1]||s[2]){i=be(e.text,r+s[0].length);if(i>-1&&e.hasOpenLink){let t=/([^\[\]]|\[[^\]]*\])*/.exec(e.text.slice(r,i));i=r+t[0].length}}else if(s[3])i=Le(e.text,r);else{i=Le(e.text,r+s[0].length);if(i>-1&&s[0]=="xmpp:"){ke.lastIndex=i;s=ke.exec(e.text);s&&(i=s.index+s[0].length)}}if(i<0)return-1;e.addElement(e.elt("URL",n,i+e.offset));return i+e.offset}}]};const Se=[ue,de,ae,Ce];function we(e,t,n){return(r,s,i)=>{if(s!=e||r.char(i+1)==e)return-1;let l=[r.elt(n,i,i+1)];for(let s=i+1;s<r.end;s++){let a=r.char(s);if(a==e)return r.addElement(r.elt(t,i,s+1,l.concat(r.elt(n,s,s+1))));a==92&&l.push(r.elt("Escape",s,2+s++));if(d(a))break}return-1}}const ye={defineNodes:[{name:"Superscript",style:o.special(o.content)},{name:"SuperscriptMark",style:o.processingInstruction}],parseInline:[{name:"Superscript",parse:we(94,"Superscript","SuperscriptMark")}]};const Ie={defineNodes:[{name:"Subscript",style:o.special(o.content)},{name:"SubscriptMark",style:o.processingInstruction}],parseInline:[{name:"Subscript",parse:we(126,"Subscript","SubscriptMark")}]};const Te={defineNodes:[{name:"Emoji",style:o.character}],parseInline:[{name:"Emoji",parse(e,t,n){let r;return t==58&&(r=/^[a-zA-Z_0-9]+:/.exec(e.slice(n+1,e.end)))?e.addElement(e.elt("Emoji",n,n+1+r[0].length)):-1}}]};export{Ce as Autolink,BlockContext,Element,Te as Emoji,Se as GFM,InlineContext,LeafBlock,Line,MarkdownParser,ae as Strikethrough,Ie as Subscript,ye as Superscript,ue as Table,de as TaskList,ie as parseCode,re as parser};

